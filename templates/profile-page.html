<!DOCTYPE html>
<html lang="en">
<head>
  <title>The Vegan Dinosaur - Admin Dashboard</title>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"></script>
  <link rel="stylesheet" href="//code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css">
  <script src="https://code.jquery.com/jquery-1.12.4.js"></script>
  <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js"></script>

<script src="https://cdn.jsdelivr.net/gh/linways/table-to-excel@v1.0.4/dist/tableToExcel.js"></script>


  <script>



function postData3(input) {
    $.ajax({
        type: "POST",
        url: "/customer-login",
        data: { param: input },
        success: callbackFunc
    });
}

    $(document).ready(function(){
    $('.editbtn').click(function () {
                var currentTD = $(this).parents('tr').find('td');
                //alert('this '+$(this).html() );
                if ($(this).text().trim() == 'Edit') {
                    currentTD = $(this).parents('tr').find($("td").not(":nth-child(1)"));
                    //alert("first if "+currentTD.html());
                    $.each(currentTD, function () {
                        $(this).prop('contenteditable', true).css({
                          'background':'#fff',
                          'color':'#000'
  
                      })
                    });
                } else {
                 // alert("second if "+currentTD.html());
                   $.each(currentTD, function () {
                      //alert("second if "+currentTD.html());
                        $(this).prop('contenteditable', false).removeAttr("style");
                    });
                }
      
                $(this).html($(this).html() == 'Edit' ? 'Save' : 'Edit')
                if ($(this).html() == 'Save'){
                 // alert("third if "+currentTD.html());
                 $("button").click(function(){
                  alert("Image width: " + $("input").attr("data"));
                });
                
                //$.post("/customer-login");
                //postData3('s')
                
                  $(this).prop('contenteditable',false)

                }
      
            });
            });



            
            $(function(){
    $('#btn').click(function() {
        alert("Hello");
        postData3("1")
    });
});


function callbackFunc(response) {
    // do something with the response
    console.log(response);
}

</script>

</head>

<body class="pricing sidebar-collapse" style="background-image: url(../static/assets/img/LONGLIVE10.jpg);">
    <nav class="navbar navbar-color-on-scroll navbar-transparent    fixed-top  navbar-expand-lg " color-on-scroll="100" id="sectionsNav" style="height:15%; left: 0; right: 0; background-image: url(../static/assets/img/header11.jpg)" >
      <div class="container">
        <div class="navbar-translate">

            <div>
    <!--a href="/shoppingcart" target="_blank" class="btn btn-round btn-block btn-sm " style ="position: sticky; top: 0; right: 0; left: 0; transform-origin: top right;">

      <i class="material-icons">shopping_cart</i> Buy Now
  </a-->

    </div>

          <!--div class="navbar-brand">
            <-a href="#home" class="active" class="navbar-brand">Home</a>
            <img src="../static/assets/img/vegan-dino-bg.ico" class="active">

          </div-->

          {% if request.MOBILE %}

          <ul class="navbar-nav mx-auto">

            <li><img src="../static/assets/img/vegan-dino-bg.ico"></li>

          </ul>

          {% else %}

          <a href="/pricing.html">
            <img src="../static/assets/img/vegan-dino-bg(2).ico" class="navbar-nav mx-auto" style="position: absolute; right: 0px; left: 0px; top: -12px; transform-origin: top center;">
          </a>


          {% endif %}
          <!--a href="/shoppingcart" target="_blank" class="btn btn-round btn-block btn-sm " style ="background-color: #94df69; position: absolute; right: 0px; top: 0px; transform-origin: top right;"-->


              <!--a href="/shoppingcart" target="_blank" class="btn btn-round btn-block btn-sm " style ="background-color: #94df69; position: absolute; right: auto; top: auto; bottom: auto; left: auto; transform-origin: top right;">

                  <i class="material-icons">shopping_cart</i> Buy Now
            </a-->
          <!--a class="navbar-brand" href="https://demos.creative-tim.com/material-kit-pro/index.html" style="color:black";>
            The Vegan Dinasour </a-->
            <!--img src="../static/assets/img/vd-resized.png" width="50" height="40" style="position: relative;
            top:-40px; margin-left:55px;
          margin-right: -55px;display: block; width: 50%; height: 50%;" -->


          <div class="collapse navbar-collapse">
            <ul class="navbar-nav ml-auto">

              <li class="button-container nav-item iframe-extern">
                <div>


                              <!--a href="/shoppingcart" target="_blank" class="btn btn-round btn-block btn-sm " style ="background-color: #94df69; position: absolute; right: auto; top: auto; bottom: auto; left: auto; transform-origin: top right;">

                  <i class="material-icons">shopping_cart</i> Buy Now
            </a-->

                  <!--img src="../static/assets/img/vegan-dino-bg.ico"-->
                  <!--a href="/shoppingcart" target="_blank" class="btn btn-round btn-block btn-sm " style ="background-color: #94df69; display: block;
                  margin-left: 1px; right: -1000px; top: -40px"-->

                  <!--a href="/shoppingcart" target="_blank" class="btn btn-round btn-block btn-sm " style ="background-color: #94df69;">

                  <i class="material-icons">shopping_cart</i> Buy Now
                  </a-->
                </div>
              </li>
            </ul>
          </div>


        </div>
          </ul>
        </div>
      </div>
    </nav>

<div class="container">
  <h2>Admin Dashboard</h2>

  <ul class="nav nav-tabs">
    <li class="active"><a data-toggle="tab" href="#home">Home</a></li>
    <li><a data-toggle="tab" href="#menu1">Orders</a></li>
    <li><a data-toggle="tab" href="#menu2">Plans</a></li>
    <li><a data-toggle="tab" href="#menu3">Customize website</a></li>
    <li><a data-toggle="tab" href="#menu4">Add customers & Plans</a></li>

  </ul>

  <div class="tab-content">
    <div id="home" class="tab-pane fade in active">
      <h3>HOME</h3>
      <a href="{{ url_for('logout') }}" class="btn btn-success btn-sm">Log out</a>

    </div>
    <div id="menu1" class="tab-pane fade">
      <h3>Orders</h3>





              <table class="table" id="simpleTable1">
    <thead>
        <tr class="text-center">
            <th class="text-center">#</th>
            <th class="text-center">Name</th>
            <th class="text-center">Mobile Number</th>
            <th class="text-center">Number of Plans</th>
            <th class="text-center">Delivery</th>
            <th class="text-center">Address</th>
            <th class="text-center">Map Direction Link</th>

        </tr>
    </thead>
    <tbody>
      {% set count = 4 %}
      {% for user in users %}

        <!--tr bgcolor="#ee4c50"-->
        <tr class="text-center">
            <td class="text-center">{{ loop.index }}</td>
            {% set count = 100 %}
            <td>{{user.name}}</td>
            <td>{{user.mobile}}</td>
            <td>{{user.number_of_plans}}</td>
            <td>{{user.delivery_option}}</td>
            <td>{{user.address}}</td>
            <td>{{user.map_link}}</td>




        </tr>
        {%endfor%}
    </tbody>
</table>

<button id="button-excel">Create Excel</button>        


    </div>
    <div id="menu2" class="tab-pane fade">
      <h3>Plans</h3>

                 <div class="row">


<table class="table table-striped table-bordered" id = "mydatatable" >
  <div class="row justify-content-center">
    <thead>
        <tr>
            <th class="text-center">#</th>
            <th>User</th>
            <th>Start Date</th>
            <th>Expiry Date</th>
            <th>Status</th>

            <th class="text-right">Actions</th>
        </tr>
    </thead>
    <tbody>
      {% set count = 4 %}
      {% for plan in plans %}

        <tr class="danger" >
            <td class="text-center">{{ loop.index }}</td>
            <td>{{plan.customer_name}}</td>
            <td>{{plan.start_date}}</td>
            <td class="editable"  onclick="myFunction()">
              <input type="text hidden" value= "{{plan.expiry_date}}" id="datepicker{{loop.index}}"  class = "datepicker" name="edit" data = "{{plan.id}}"></td>
            <td class="danger">{{plan.is_active}}</td>

            <td contenteditable="false" class="td-actions text-right">

                <!--button type="button" rel="tooltip" class="btn btn-success editbtn">
                    <i class="material-icons">Edt</i>
                </button-->
                <a href="{{ url_for('cancelPlan', plan_id = plan.id) }}" class="btn btn-danger btn-sm">Cancel</a>

                <a href="{{ url_for('editPlan', plan_id = plan.id) }}" class="btn btn-success btn-sm">Edit</a>

            </td>
        </tr>
        {%endfor%}
    </tbody>
    <div class="row justify-content-center">
</table>



    </div>


    </div>
    <div id="menu3" class="tab-pane fade">
      <h3>Customize Website</h3>

                    <div class="row">
                <form class="form" method="POST" action="/customize">
                    <div class="row justify-content-center">
                      <div class="form-group">
                        <label for="sel1" style="color:red"> * Please choose plan you wish to amend price for:  </label>
                          <select class="form-control" id="sel1" name="price">
                           <option>Day</option>
                            <option>Week</option>
                            <option>Month</option>
                        </select>
                      </div>
                      <div class="form-group">
                        <div class="input-group">
                          <div class="input-group-prepend">
                            <span class="input-group-text">
                              <!--i class="material-icons">attach_money</i-->
                            </span>
                        </div>
                          <input type="number" step="0.01" placeholder="Amount..." class="form-control" name="price_amount"/>
                      </div>
                    </div>
                    <div class="text-center">
                      <input type="submit" href="/customize" class="btn btn-primary btn-round"></input>
                    </div>
                </form>
                <div class="text-center">
                  <!--input type="submit" href="/updateAdmin" class="btn btn-primary btn-round"></input-->
                </div>
              </div>
            </div>
    </div>
    <div id="menu4" class="tab-pane fade">
      <h3>Menu 4</h3>
      <p>Under Construction ...</p>
    </div>
  </div>
</div>

</body>

<script>

    $('#mydatatable').DataTable( {
    keys: true
} );
</script>
</script>

<script>
  function myFunction() {
    //alert("I am an alert box!");
  }

  $(function() {
    $(".editable").click(function() {
        if ($(this).attr("contentEditable") == "true") {
            $( "#hello" ).show();
            alert("yes");
            //$( ".datepicker" ).datepicker().show();
            $(this).parent().find('.datepicker').focus();
        } else {
            alert("no");
          $( "#hello" ).hide(); 
        }
    });
});




$('.datepicker').datepicker({
    dateFormat: 'yy-dd-mm',
    onClose: function(dateText, inst) {
        // When the date is selected, copy the value in the content editable div.
        // If you don't need to do anything on the blur or focus event of the content editable div, you don't need to trigger them as I do in the line below.
        $(this).parent().find('.edir').focus().html(dateText).blur();
    }
});

let button = document.querySelector("#button-excel");

button.addEventListener("click", e => {
  let table = document.querySelector("#simpleTable1");
  TableToExcel.convert(table);
});

  </script>




</html>
